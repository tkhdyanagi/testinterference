<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="testinterference">
<title>Testing Procedure: Fisher's Sharp Null Hypothesis • testinterference</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Testing Procedure: Fisher's Sharp Null Hypothesis">
<meta property="og:description" content="testinterference">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">testinterference</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/testinterference.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/exposure1.html">Testing Procedure: Exposure 1</a>
    <a class="dropdown-item" href="../articles/exposure2.html">Testing Procedure: Exposure 2</a>
    <a class="dropdown-item" href="../articles/Fisher.html">Testing Procedure: Fisher's Sharp Null Hypothesis</a>
    <a class="dropdown-item" href="../articles/SUTVA.html">Testing Procedure: Stable Unit Treatment Value Assumption (SUTVA)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Testing Procedure: Fisher's Sharp Null Hypothesis</h1>
                        <h4 data-toc-skip class="author">Tadao Hoshino
(<a href="mailto:thoshino@waseda.jp" class="email">thoshino@waseda.jp</a>), Takahide Yanagi (<a href="mailto:yanagi@econ.kyoto-u.ac.jp" class="email">yanagi@econ.kyoto-u.ac.jp</a>)</h4>
            
      
      
      <div class="d-none name"><code>Fisher.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes the testing procedure implemented in the
<code><a href="../reference/testinterference.html">testinterference()</a></code> function when
<code>hypothesis = "Fisher"</code>.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Consider a finite population of <span class="math inline">\(n\)</span> units, <span class="math inline">\([n]
= \{ 1, \dots, n \}\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{Z} = (Z_1, \dots,
Z_n)\)</span> denote the <span class="math inline">\(n\)</span>-dimensional binary vector of realized
treatment assignments. Suppose that <span class="math inline">\(\mathbf{Z} \sim \mathbb{P}_{\mathbf{Z}}\)</span>
for a known assignment probability <span class="math inline">\(\mathbb{P}_{\mathbf{Z}}\)</span> (i.e., the
experimental design). For instance, <span class="math inline">\(\mathbb{P}_{\mathbf{Z}}\)</span> may be Bernoulli
randomization, complete randomization, stratified randomization, or
other experimental designs. We write the set of all possible assignment
patterns <span class="math inline">\(\mathcal{Z} = \{ \mathbf{z} \in \{
0, 1 \}^n: \mathbb{P}_{\mathbf{Z}}(\mathbf{z}) &gt; 0 \}\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{Y} = (Y_1, \dots,
Y_n)\)</span>, where <span class="math inline">\(Y_i\)</span> denotes
the outcome variable for unit <span class="math inline">\(i\)</span>.</p>
</div>
<div class="section level2">
<h2 id="null-hypothesis">Null Hypothesis<a class="anchor" aria-label="anchor" href="#null-hypothesis"></a>
</h2>
<p>Suppose that there is no interference so that the outcome for each
unit does not depend on others’ treatment assignments. Then, the
potential outcome for unit <span class="math inline">\(i\)</span> given
<span class="math inline">\(Z_i = z\)</span> for <span class="math inline">\(z \in \{ 0, 1 \}\)</span> is well defined, which
we denote <span class="math inline">\(Y_i(z)\)</span>.</p>
<p>Fisher’s sharp null hypothesis is <span class="math display">\[\begin{align*}
    \mathbb{H}_0: \quad
    Y_i(1) = Y_i(0)
    \quad \text{for all $i \in [n]$}.
\end{align*}\]</span> This states that the outcome for each unit does
not depend on unit’s own treatment assignment. If we find statistical
evidence against this hypothesis, it suggests the presence of some
treatment effects.</p>
</div>
<div class="section level2">
<h2 id="randomization-test">Randomization Test<a class="anchor" aria-label="anchor" href="#randomization-test"></a>
</h2>
<p>The main idea behind testing the null hypothesis is to check whether
the outcome distribution given <span class="math inline">\(Z_i =
1\)</span> is identical to that given <span class="math inline">\(Z_i =
0\)</span>. Specifically, the testing procedure is as follows:</p>
<ol style="list-style-type: decimal">
<li>Choose a test statistic <span class="math inline">\(T(\mathbf{z},
\mathbf{y})\)</span>.</li>
<li>Compute <span class="math inline">\(T(\mathbf{Z},
\mathbf{Y})\)</span> with the realized treatment assignment <span class="math inline">\(\mathbf{Z}\)</span> and the observed outcome <span class="math inline">\(\mathbf{Y}\)</span>.</li>
<li>Draw <span class="math inline">\(\mathbf{z}^{(r)}\)</span>
independently from <span class="math inline">\(\mathbb{P}_{\mathbf{Z}}\)</span>.</li>
<li>Compute <span class="math inline">\(T(\mathbf{z}^{(r)},
\mathbf{Y})\)</span> under <span class="math inline">\(\mathbb{H}_0\)</span>.</li>
<li>Repeat the above two steps <span class="math inline">\(R\)</span>
times.</li>
<li>Compute the <span class="math inline">\(p\)</span>-value by <span class="math display">\[\begin{align*}
  \text{$p$-value}
  = \frac{1}{R} \sum_{r=1}^{R} \mathbf{1}\{ T(\mathbf{z}^{(r)},
\mathbf{Y}) \ge T(\mathbf{Z}, \mathbf{Y}) \}.
\end{align*}\]</span>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="test-statistics">Test Statistics<a class="anchor" aria-label="anchor" href="#test-statistics"></a>
</h2>
<p>In the <strong>testinterference</strong> package, we consider three
test statistics.</p>
<ul>
<li>Kruskal-Wallis (KW)</li>
<li>Average cross difference (ACD)</li>
<li>Ordinary least squares (OLS)</li>
</ul>
<p>To define these statistics, we add some notations. For a given
treatment assignment <span class="math inline">\(\mathbf{z}\)</span>, we
partition the sample into 2 groups: <span class="math display">\[\begin{align*}
    \mathcal{S}_1(\mathbf{z}) &amp; = \{ i \in [n]: Z_i = 0 \}, \\
    \mathcal{S}_2(\mathbf{z}) &amp; = \{ i \in [n]: Z_i = 1 \}.
\end{align*}\]</span></p>
<div class="section level4">
<h4 id="kw-statistic">KW statistic<a class="anchor" aria-label="anchor" href="#kw-statistic"></a>
</h4>
<p>We begin by ranking all <span class="math inline">\((Y_1, \dots,
Y_n)\)</span> from 1 to <span class="math inline">\(n\)</span>. Let
<span class="math inline">\(v_i\)</span> be the rank of <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(V_j(\mathbf{z})\)</span> be the summation of the
ranks for group <span class="math inline">\(\mathcal{S}_j(\mathbf{z})\)</span>: <span class="math inline">\(V_j(\mathbf{z}) = \sum_{i \in
\mathcal{S}_j(\mathbf{z})} v_i\)</span>, where <span class="math inline">\(j = 1, 2\)</span>. The KW statistic compares the
average rank for each group <span class="math inline">\(j\)</span>,
<span class="math inline">\(V_j(\mathbf{z}) /
|\mathcal{S}_j(\mathbf{z})|\)</span>, with the average rank for the
whole sample, <span class="math inline">\((n + 1) / 2\)</span>: <span class="math display">\[\begin{align*}
    T(\mathbf{z}, \mathbf{Y})
    = \frac{12}{n (n + 1)} \sum_{j=1}^2 | \mathcal{S}_j(\mathbf{z}) |
\left( \frac{ V_j(\mathbf{z}) }{ |\mathcal{S}_j(\mathbf{z})| } - \frac{n
+ 1}{2} \right)^2.
\end{align*}\]</span></p>
</div>
<div class="section level4">
<h4 id="acd-statistic">ACD statistic<a class="anchor" aria-label="anchor" href="#acd-statistic"></a>
</h4>
<p>The ACD statistic is defined simply as the absolute average
difference between the two groups: <span class="math display">\[\begin{align*}
    T(\mathbf{z}, \mathbf{Y})
    = \left| \frac{1}{|\mathcal{S}_1(\mathbf{z})|} \sum_{i \in
\mathcal{S}_1(\mathbf{z})} Y_i - \frac{1}{|\mathcal{S}_2(\mathbf{z})|}
\sum_{i \in \mathcal{S}_2(\mathbf{z})} Y_i \right|.
\end{align*}\]</span></p>
</div>
<div class="section level4">
<h4 id="ols-statistic">OLS statistic<a class="anchor" aria-label="anchor" href="#ols-statistic"></a>
</h4>
<p>The OLS statistic is defined as the <span class="math inline">\(F\)</span>-statistic for the significance of <span class="math inline">\(\beta_2\)</span> in the OLS estimation of the
following linear model: <span class="math display">\[\begin{align*}
    Y_i = \beta_1 + \beta_2 z_i + \text{error}_i,
\end{align*}\]</span> where <span class="math inline">\(z_i\)</span>
denotes the <span class="math inline">\(i\)</span>-th element of a given
treatment assignment vector <span class="math inline">\(\mathbf{z} =
(z_1, \dots, z_n)\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="simes-correction">Simes’ Correction<a class="anchor" aria-label="anchor" href="#simes-correction"></a>
</h2>
<p>Since we have multiple test statistics, it would be desirable to
consider some correction for multiple testing. In the
<strong>testinterference</strong> package, we implement Simes’
correction. Specifically, letting <span class="math inline">\(p^{(1)}
\le \dots \le p^{(s)}\)</span> denote the ordered <span class="math inline">\(p\)</span>-values obtained from <span class="math inline">\(s\)</span> different test statistics, we reject
the null hypothesis <span class="math inline">\(\mathbb{H}_0\)</span>
under the significance level <span class="math inline">\(\alpha\)</span>
if <span class="math inline">\(p^{(j)} \le j \cdot \alpha / s\)</span>
for some <span class="math inline">\(j = 1, \dots, s\)</span>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Hoshino, T. and Yanagi, T., 2023. Randomization test for the
specification of interference structure arXiv preprint arXiv:2301.05580.
<a href="https://doi.org/10.48550/arXiv.2301.05580" class="external-link">Link</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tadao Hoshino, Takahide Yanagi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
