<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="testinterference">
<title>Testing Procedure: Stable Unit Treatment Value Assumption (SUTVA) â€¢ testinterference</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Testing Procedure: Stable Unit Treatment Value Assumption (SUTVA)">
<meta property="og:description" content="testinterference">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">testinterference</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/testinterference.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/exposure1.html">Testing Procedure: Exposure 1</a>
    <a class="dropdown-item" href="../articles/exposure2.html">Testing Procedure: Exposure 2</a>
    <a class="dropdown-item" href="../articles/Fisher.html">Testing Procedure: Fisher's Sharp Null Hypothesis</a>
    <a class="dropdown-item" href="../articles/SUTVA.html">Testing Procedure: Stable Unit Treatment Value Assumption (SUTVA)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Testing Procedure: Stable Unit Treatment Value Assumption (SUTVA)</h1>
                        <h4 data-toc-skip class="author">Tadao Hoshino
(<a href="mailto:thoshino@waseda.jp" class="email">thoshino@waseda.jp</a>), Takahide Yanagi (<a href="mailto:yanagi@econ.kyoto-u.ac.jp" class="email">yanagi@econ.kyoto-u.ac.jp</a>)</h4>
            
      
      
      <div class="d-none name"><code>SUTVA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes the testing procedure implemented in the
<code><a href="../reference/testinterference.html">testinterference()</a></code> function when
<code>hypothesis = "SUTVA"</code>.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Consider a finite population of <span class="math inline">\(n\)</span> units, <span class="math inline">\([n]
= \{ 1, \dots, n \}\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{Z} = (Z_1, \dots,
Z_n)\)</span> denote the <span class="math inline">\(n\)</span>-dimensional binary vector of realized
treatment assignments. Suppose that <span class="math inline">\(\mathbf{Z} \sim \mathbb{P}_{\mathbf{Z}}\)</span>
for a known assignment probability <span class="math inline">\(\mathbb{P}_{\mathbf{Z}}\)</span> (i.e., the
experimental design). For instance, <span class="math inline">\(\mathbb{P}_{\mathbf{Z}}\)</span> may be Bernoulli
randomization, complete randomization, stratified randomization, or
other experimental designs. We write the set of all possible assignment
patterns <span class="math inline">\(\mathcal{Z} = \{ \mathbf{z} \in \{
0, 1 \}^n: \mathbb{P}_{\mathbf{Z}}(\mathbf{z}) &gt; 0 \}\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{Y} = (Y_1, \dots,
Y_n)\)</span>, where <span class="math inline">\(Y_i\)</span> denotes
the outcome variable for unit <span class="math inline">\(i\)</span>.</p>
<p>Let <span class="math inline">\(\mathbf{A} = (A_{ij})_{i,j \in
[n]}\)</span> be the adjacency matrix, where <span class="math inline">\(A_{ij} \in \{ 0, 1 \}\)</span> represents whether
<span class="math inline">\(j\)</span> affects <span class="math inline">\(i\)</span>. We set <span class="math inline">\(A_{ii} = 0\)</span> for all <span class="math inline">\(i\)</span>. For each <span class="math inline">\(i\)</span>, the set of interacting peers is
defined as <span class="math inline">\(\mathcal{P}_i = \{ j \in [n]:
A_{ij} = 1 \}\)</span>.</p>
</div>
<div class="section level2">
<h2 id="null-hypothesis">Null Hypothesis<a class="anchor" aria-label="anchor" href="#null-hypothesis"></a>
</h2>
<p>For each treatment assignment <span class="math inline">\(\mathbf{z}
= (z_1, \dots, z_n)\)</span>, we consider the two exposure mappings:
<span class="math display">\[\begin{align*}
  E_i^0(\mathbf{z}) &amp; = z_i, \\
  E_i^1(\mathbf{z}) &amp; = \left( z_i, \; \max_{j \in \mathcal{P}_i}
z_j \right).
\end{align*}\]</span> Here, the second element of the latter exposure
mapping corresponds to whether there is at least one treated peer. Let
<span class="math inline">\(E_i^0 = E_i^0(\mathbf{Z})\)</span> and <span class="math inline">\(E_i^1 = E_i^1(\mathbf{Z})\)</span> denote the
exposures computed with the realized treatment assignments <span class="math inline">\(\mathbf{Z}\)</span>.</p>
<p>The exposure mapping <span class="math inline">\(E^0\)</span> is said
to be <em>correct</em> if the potential outcome given <span class="math inline">\(E_i^0 = e^0\)</span> is well defined for any <span class="math inline">\(i\)</span>. A key insight behind the randomization
test discussed below is that, if <span class="math inline">\(E^0\)</span> is correct, then <span class="math inline">\(E^1\)</span> is also correct. Under the null
hypothesis, we write the potential outcome given <span class="math inline">\(E_i^1 = e^1\)</span> as <span class="math inline">\(y_i^1(e^1)\)</span>.</p>
<p>The null hypothesis of interest is <span class="math display">\[\begin{align*}
    \mathbb{H}_0: \quad
    \text{The exposure mapping $E^0$ is correct.}
\end{align*}\]</span> This states that the outcome for each unit is
determined by oneâ€™s own treatment assignment. If we find statistical
evidence against this hypothesis, it implies the presence of some
spillover effects.</p>
</div>
<div class="section level2">
<h2 id="randomization-test">Randomization Test<a class="anchor" aria-label="anchor" href="#randomization-test"></a>
</h2>
<p>The main idea behind testing the null hypothesis is to check whether
the outcome distribution given <span class="math inline">\(Z_i\)</span>
and <span class="math inline">\(\max_{j \in \mathcal{P}_i} Z_j\)</span>
does not depend on <span class="math inline">\(\max_{j \in
\mathcal{P}_i} Z_j\)</span>.</p>
<p>To be specific, in line with the notation in <a href="https://doi.org/10.48550/arXiv.2301.05580" class="external-link">Hoshino and Yanagi
(2023)</a>, let <span class="math inline">\(\tilde{\mathcal{E}}_i^1 = \{
(Z_i, 0), (Z_i, 1) \}\)</span> for each <span class="math inline">\(i\)</span> such that <span class="math inline">\(|\mathcal{P}_i| &gt; 0\)</span>. Then, under the
null hypothesis <span class="math inline">\(\mathbb{H}_0\)</span>, we
have <span class="math display">\[\begin{align*}
    Y_i = y_i^1(e^1)
    \quad
    \text{for all $e^1 \in \tilde{\mathcal{E}}_i^1$.}
\end{align*}\]</span> Thus, the values of all <span class="math inline">\(\{ y_i^1(e^1): e^1 \in \tilde{\mathcal{E}}_i^1
\}\)</span> are identically imputable as <span class="math inline">\(Y_i\)</span>. Given this, using the test
statistics introduced below, we can test whether the following equality
under <span class="math inline">\(\mathbb{H}_0\)</span> is true: <span class="math display">\[\begin{align*}
    y_i^1(e_j^1) = y_i^1(e_k^1)
    \quad
    \text{for all $e_j^1, e_k^1 \in \tilde{\mathcal{E}}_i^1$.}
\end{align*}\]</span> We reject the null hypothesis if we find
statistical evidence against this equality.</p>
<p>As discussed in <a href="https://doi.org/10.48550/arXiv.2301.05580" class="external-link">Hoshino and Yanagi
(2023)</a>, we must carefully select the appropriate subsets of units
and treatment assignments, which we call the <em>focal
sub-population</em> (the set of <em>focal units</em>) and <em>focal
assignments</em>, respectively. For the null hypothesis considered here,
we can construct the focal sub-population <span class="math inline">\(\mathcal{S}\)</span> as an appropriate subset of
<span class="math display">\[\begin{align*}
  \mathcal{N}(2) = \left\{ i \in [n]: |\mathcal{P}_i| &gt; 0 \right\}.
\end{align*}\]</span> Then, for given <span class="math inline">\(\mathcal{S}\)</span>, the set of focal assignments
is defined as <span class="math display">\[\begin{align*}
  \mathcal{C}^{\mathcal{S}} = \left\{ \mathbf{z} \in \mathcal{Z}: z_i =
Z_i \; \text{for all $i \in \mathcal{S}$} \right\},
\end{align*}\]</span> where <span class="math inline">\(z_i\)</span>
denotes the <span class="math inline">\(i\)</span>-th element of <span class="math inline">\(\mathbf{z}\)</span>. See <a href="https://doi.org/10.48550/arXiv.2301.05580" class="external-link">Hoshino and Yanagi
(2023)</a> for more details.</p>
<p>Let <span class="math inline">\(\mathbf{Y}_{\mathcal{S}} = (Y_i)_{i
\in \mathcal{S}}\)</span> denote the vector that collects the outcomes
for focal units.</p>
<p>The testing procedure is as follows:</p>
<ol style="list-style-type: decimal">
<li>Choose a test statistic <span class="math inline">\(T(\mathbf{z},
\mathbf{y}_{\mathcal{S}})\)</span>.</li>
<li>Compute <span class="math inline">\(T(\mathbf{Z},
\mathbf{Y}_{\mathcal{S}})\)</span> with the realized treatment
assignment <span class="math inline">\(\mathbf{Z}\)</span> and the
observed outcome vector <span class="math inline">\(\mathbf{Y}_{\mathcal{S}}\)</span> for focal
units.</li>
<li>Draw <span class="math inline">\(\mathbf{z}^{(r)}\)</span>
independently from <span class="math inline">\(\mathbb{P}_{\mathbf{Z} |
\mathbf{Z} \in \mathcal{C}^{\mathcal{S}}}\)</span>.</li>
<li>Compute <span class="math inline">\(T(\mathbf{z}^{(r)},
\mathbf{Y}_{\mathcal{S}})\)</span> under <span class="math inline">\(\mathbb{H}_0\)</span>.</li>
<li>Repeat the above two steps <span class="math inline">\(R\)</span>
times.</li>
<li>Compute the <span class="math inline">\(p\)</span>-value by <span class="math display">\[\begin{align*}
  \text{$p$-value}
  = \frac{1}{R} \sum_{r=1}^{R} \mathbf{1}\{ T(\mathbf{z}^{(r)},
\mathbf{Y}_{\mathcal{S}}) \ge T(\mathbf{Z}, \mathbf{Y}_{\mathcal{S}})
\}.
\end{align*}\]</span>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="test-statistics">Test Statistics<a class="anchor" aria-label="anchor" href="#test-statistics"></a>
</h2>
<p>In the <strong>testinterference</strong> package, we consider three
test statistics.</p>
<ul>
<li>Kruskal-Wallis (KW)</li>
<li>Average cross difference (ACD)</li>
<li>Ordinary least squares (OLS)</li>
</ul>
<p>To define these statistics, we add some notations. For a given
treatment assignment <span class="math inline">\(\mathbf{z}\)</span>, we
partition the focal sub-population <span class="math inline">\(\mathcal{S}\)</span> into 2 groups: <span class="math display">\[\begin{align*}
    \mathcal{S}_1(\mathbf{z}) &amp; = \left\{ i \in \mathcal{S}: \max_{j
\in \mathcal{P}_i} z_j = 0 \right\}, \\
    \mathcal{S}_2(\mathbf{z}) &amp; = \left\{ i \in \mathcal{S}: \max_{j
\in \mathcal{P}_i} z_j = 1 \right\}.
\end{align*}\]</span></p>
<div class="section level4">
<h4 id="kw-statistic">KW statistic<a class="anchor" aria-label="anchor" href="#kw-statistic"></a>
</h4>
<p>We begin by ranking all <span class="math inline">\((Y_i)_{i \in
\mathcal{S}}\)</span> from 1 to <span class="math inline">\(|\mathcal{S}|\)</span>. Let <span class="math inline">\(v_i\)</span> be the rank of <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(V_j(\mathbf{z})\)</span> be the summation of the
ranks for group <span class="math inline">\(\mathcal{S}_j(\mathbf{z})\)</span>: <span class="math inline">\(V_j(\mathbf{z}) = \sum_{i \in
\mathcal{S}_j(\mathbf{z})} v_i\)</span>, where <span class="math inline">\(j = 1, 2\)</span>. The KW statistic compares the
average rank for each group <span class="math inline">\(j\)</span>,
<span class="math inline">\(V_j(\mathbf{z}) /
|\mathcal{S}_j(\mathbf{z})|\)</span>, with the average rank for the
entire <span class="math inline">\(|\mathcal{S}|\)</span>, <span class="math inline">\((|\mathcal{S}| + 1) / 2\)</span>: <span class="math display">\[\begin{align*}
    T(\mathbf{z}, \mathbf{Y})
    = \frac{12}{|\mathcal{S}| ( |\mathcal{S}| + 1 )} \sum_{j=1}^2 |
\mathcal{S}_j(\mathbf{z}) | \left( \frac{ V_j(\mathbf{z}) }{
|\mathcal{S}_j(\mathbf{z})| } - \frac{|\mathcal{S}| + 1}{2} \right)^2.
\end{align*}\]</span></p>
</div>
<div class="section level4">
<h4 id="acd-statistic">ACD statistic<a class="anchor" aria-label="anchor" href="#acd-statistic"></a>
</h4>
<p>The ACD statistic is defined simply as the absolute average
difference between the two groups: <span class="math display">\[\begin{align*}
    T(\mathbf{z}, \mathbf{Y})
    = \left| \frac{1}{|\mathcal{S}_1(\mathbf{z})|} \sum_{i \in
\mathcal{S}_1(\mathbf{z})} Y_i - \frac{1}{|\mathcal{S}_2(\mathbf{z})|}
\sum_{i \in \mathcal{S}_2(\mathbf{z})} Y_i \right|.
\end{align*}\]</span></p>
</div>
<div class="section level4">
<h4 id="ols-statistic">OLS statistic<a class="anchor" aria-label="anchor" href="#ols-statistic"></a>
</h4>
<p>The OLS statistic is defined as the <span class="math inline">\(F\)</span>-statistic for the significance of <span class="math inline">\(\beta_2\)</span> in the OLS estimation of the
following linear model: <span class="math display">\[\begin{align*}
    Y_i = \beta_0 + \beta_1 z_i + \beta_2 \left( \max_{j \in
\mathcal{P}_i} z_j \right) + \text{error}_i
    \qquad
    \text{for $i \in \mathcal{S}$},
\end{align*}\]</span> where <span class="math inline">\(z_i\)</span>
denotes the <span class="math inline">\(i\)</span>-th element of a given
treatment assignment vector <span class="math inline">\(\mathbf{z} =
(z_1, \dots, z_n)\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="simes-correction">Simesâ€™ Correction<a class="anchor" aria-label="anchor" href="#simes-correction"></a>
</h2>
<p>Since we have multiple test statistics, it would be desirable to
consider some correction for multiple testing. In the
<strong>testinterference</strong> package, we implement Simesâ€™
correction. Specifically, letting <span class="math inline">\(p^{(1)}
\le \dots \le p^{(s)}\)</span> denote the ordered <span class="math inline">\(p\)</span>-values obtained from <span class="math inline">\(s\)</span> different test statistics, we reject
the null hypothesis <span class="math inline">\(\mathbb{H}_0\)</span>
under the significance level <span class="math inline">\(\alpha\)</span>
if <span class="math inline">\(p^{(j)} \le j \cdot \alpha / s\)</span>
for some <span class="math inline">\(j = 1, \dots, s\)</span>.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Hoshino, T. and Yanagi, T., 2023. Randomization test for the
specification of interference structure arXiv preprint arXiv:2301.05580.
<a href="https://doi.org/10.48550/arXiv.2301.05580" class="external-link">Link</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tadao Hoshino, Takahide Yanagi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
